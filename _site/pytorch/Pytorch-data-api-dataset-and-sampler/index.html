<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Pytorch data api : sampler and dataset style - Woongjoon_AI</title>
<meta name="description" content="Pytorch에서 dataset and data sampler">


  <meta name="author" content="Choi Woongjoon">
  
  <meta property="article:author" content="Choi Woongjoon">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Woongjoon_AI">
<meta property="og:title" content="Pytorch data api : sampler and dataset style">
<meta property="og:url" content="/pytorch/Pytorch-data-api-dataset-and-sampler/">


  <meta property="og:description" content="Pytorch에서 dataset and data sampler">







  <meta property="article:published_time" content="2022-03-10T00:00:00+09:00">





  

  


<link rel="canonical" href="/pytorch/Pytorch-data-api-dataset-and-sampler/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Choi Woongjoon",
      "url": "/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Woongjoon_AI Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Woongjoon_AI
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="https://kau365-my.sharepoint.com/:b:/g/personal/oongjoon_kau_kr/EUebRgY_s5xFikJdu4cCTZgBSeQd5DRoslVvEaEhYt2WYw?e=kNtQkx">CV</a>
            </li><li class="masthead__menu-item">
              <a href="https://kau365-my.sharepoint.com/:b:/g/personal/oongjoon_kau_kr/EY70u-guz5BOnxNWqBdBcrIBoAbFny3p8tUOcPE8x7QZTA?e=h34VMJ">CV_KR</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="/" itemprop="url">Choi Woongjoon</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>I am an <strong>amazing</strong> developer.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Goyang/Korea</span>
        </li>
      

      
        
          
            <li><a href="mailto:oongjoon10@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://sites.google.com/view/woognjunchoiai/%ED%99%88" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://twitter.com/ANWTNev5jkzYwoC" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
        
          
            <li><a href="https://github.com/woongjoonchoi" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
  
    
  
    <!--전체 글 수를 세기 위한 연산. sum 변수에 전체 글 수 저장-->



<nav class="nav__list">
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items" id="category_tag_menu">
      <!--전체 글 수-->
      <li>
            📂 <span style="font-family:'Cafe24Oneprettynight';">전체 글 수</style> <span style="font-family:'Coming Soon';">80</style> <span style="font-family:'Cafe24Oneprettynight';">개</style> 
      </li>
      <li>
        <!--span 태그로 카테고리들을 크게 분류 ex) C/C++/C#-->

        <span class="nav__sub-title">Programming</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Python" class="">Python(9)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            
        <span class="nav__sub-title">Coding Interview</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                        <li><a href="/categories/CodingInterview/CodingTest" class="">CodingTest (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/CodingInterview/CodingInterview" class="">CodingInterview (3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/CodingInterview/Codingtechnique" class="">Codingtechnique (3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">Computer Science</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DataStructure" class="">DataStructure (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Algorithm" class="">Algorithm (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>

      </li>
        <span class="nav__sub-title">DeepLearning</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Pytorch" class="">Pytorch (3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Huggingface" class="">Huggingface (4)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Optimization" class="">Optimization (5)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/NLP" class="">NLP (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>    
           <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DLArchitecture" class="">DLArchitecture (3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">Software Engineering</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/CICD" class="">CI/CD (8)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>     
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/OS" class="">Operating System  (1)</a></li>
                    
                
                    
                
                    
                
            </ul>     
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Tools" class="">Tools (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>     
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Development" class="">Development (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Network" class="">Network (6)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>


        <span class="nav__sub-title">DeepLearningSpecialization</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DLS_C3" class="">ML Strategy(2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DLS_C2" class="">DLS Assignment(2)</a></li>
                    
                
                    
                
                    
                
                    
                
            </ul>

        <span class="nav__sub-title">ML</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ML/StandfordML" class="">StandfordML(1)</a></li>
                    
                
            </ul>
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ML/modeloptimization" class="">ModelOptimization(4)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ML/Handsonmachinelearning" class="">Handsonmachinelearning(1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/ML/PatternRecognitionML" class="">Pattern Recognition and Machine Learning(1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
      </li>
        <span class="nav__sub-title">Data Engineering</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                        <li><a href="/categories/Data-Engineering-basic" class="">Data Engineering기본 (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">GCP</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/GCP/Bigquery" class="">Bigquery(3)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>

        <span class="nav__sub-title">Mathmatics</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>

                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Mathmatics/Linear_Algebra" class="">Linear Algebra (2)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
            <ul>
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Mathmatics/Statisticd" class="">Statistics (1)</a></li>
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">DeepLearningAI NLP</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/DeepLearningai_nlp" class="">DeepLearning.ai nlp qa (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        <span class="nav__sub-title">Data Analytics</span>
            <!--ul 태그로 같은 카테고리들 모아둔 페이지들 나열-->
            <ul>
                <!--Cpp 카테고리 글들을 모아둔 페이지인 /categories/cpp 주소의 글로 링크 연결-->
                <!--category[1].size 로 해당 카테고리를 가진 글의 개수 표시--> 
                
                    
                
                    
                
                    
                
                    
                        <li><a href="/categories/Visualization" class="">Data Visualization (1)</a></li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
      </li>
  </ul>
</nav>
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Pytorch data api : sampler and dataset style">
    <meta itemprop="description" content="Pytorch에서 dataset and data sampler">
    <meta itemprop="datePublished" content="2022-03-10T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="/pytorch/Pytorch-data-api-dataset-and-sampler/" class="u-url" itemprop="url">Pytorch data api : sampler and dataset style
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          11 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#dataset">Dataset</a><ul><li><a href="#map-style-dataset">Map-style dataset</a><ul><li><a href="#using-with-dataloader">Using with Dataloader</a></li></ul></li><li><a href="#iterable-style-dataset">Iterable-style dataset</a><ul><li><a href="#using-with-dataloader-1">Using with Dataloader</a></li></ul></li></ul></li><li><a href="#data-loading-in-map-style-dataset">Data loading in map-style dataset</a><ul><li><a href="#sampler">Sampler</a></li><li><a href="#integer-indicies-sampler">Integer Indicies Sampler</a><ul><li><a href="#default-sampler">default sampler</a></li><li><a href="#shuffle-sampler">shuffle sampler</a></li></ul></li></ul></li><li><a href="#non-integral-sampler">Non-integral sampler</a></li><li><a href="#custom-batch-sampler">Custom batch Sampler</a><ul><li><a href="#using-default-sampler-argument">using default sampler argument</a></li><li><a href="#using-batch-sampler-argument">using batch sampler argument</a></li></ul></li><li><a href="#iterative-with-sampler-not-allowed">Iterative with Sampler not allowed</a></li></ul></li></ul>

            </nav>
          </aside>
        
        <p>23.12.01  Customsapmler code수정 : sampler는 indicies/key 를 넘겨야하기 때문에 dic-&gt; dic.keys()로 수정</p>

<p>인공지능의 알고리즘이 점점 더 복잡해지지만, 딥러닝 1.0수준에서만 고려하면 , 이는 feature가 점점 더 복잡해짐을 의미합니다. 즉, data에 대한 hand engineering이 더 많아짐을 의미합니다. 이는 feature가 점점 더 복잡해지고 , data에 대한 hand engineering 비중이 더 커짐을 의미합니다.</p>

<p>예를 들면 , object detction 의 경우 label 이외에도 , 여러가지 것들( bounding box , object, multi object label..etc) 같은 추가적인 feature engineering이 필요합니다. image recognition 에 비해서 좀 더 많은 비용이 들어갑니다. natural language processing의 경우  , 단어를 토큰화 해서 , lookup table을 만드는 feature engineering이 필요합니다. question answering의 경우 answer span에 대한 정보와 , passage가 길어서 잘렸을 때 , 이에 대한 offset을 계산하는등 추가적인 feature engineering이 필요합니다. text classification이 label 1개만 필요한 것과 비교하면 상대적으로 cost가 많이 들어갑니다.</p>

<p>이는 딥러닝 1.0의 특성상 , 주어진 feature의 distribution을 학습하기에 feature를 어떻게 실험하는지가 중요합니다. 따라서, data feature engineering을 하는 법을 알아야하고, 이를 위해서는 , pytorch data api를 사용할 줄 알아야 합니다. 딥러닝 2.0으로 점점 넘어가는 추세가 될 것이지만, 아직 까지는 딥러닝 1.0이 대세이기에 이러한 data feature engieering은 중요한 craft라 볼 수 있습니다.</p>

<h1 id="dataset">Dataset</h1>

<p>딥러닝 모델을 훈련할려면 data를 사용해야 하는데, 이를 사용하기 위한 api specification을 dataset이라고 부릅니다. 이러한 api 를 Pytorch에서는 torch.utils.data.Dataset class로 implementation을 해 놓았습니다. 따라서, Pytorch에서 Dataset class를 사용하면 직접 implementation을 하지 않아도 됩니다. 하지만, 몇몇 method를 override 해놓도록 implementation이 되어 있기에 공부하는데 도움이 된다고 할 수 있습니다.</p>

<h2 id="map-style-dataset">Map-style dataset</h2>

<p>map-style dataset은 (non-integral)indicies or keys 로부터 data sample로의 map을 나타냅니다.</p>

<p>map-style dataset은 아래와 같은 protocol(method)를 구현해야 합니다.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">__getitem(idx)__ </code></li>
  <li><code class="language-plaintext highlighter-rouge">__len__</code></li>
</ul>

<p>이러한 map-style dataset에 대한 api를 제공해주는 것이 torch의 utils.data.Dataset class입니다. 이는 abstract class 인데 , 구현을 해야만 하는 method는 <code class="language-plaintext highlighter-rouge">__ getitem(idx)__</code> 이고 , optional 한 부분은 <code class="language-plaintext highlighter-rouge">__len()__</code> 입니다.</p>

<p><code class="language-plaintext highlighter-rouge">__getitem(idx)__</code> 는 어떤 key(idx) 가 주어지면 data sample을 fetching하도록 도와줍니다. 이 때 , key는 꼭 integer일 필요는 없습니다.</p>

<p><code class="language-plaintext highlighter-rouge">__len__</code> method는 dataloader 를 iterate 할 때에는 무조건 필요합니다.  docs에는 많은 sampler implementation들이 daatloader의 default option으로 인해서 dataset size를 반환할 것이라 예상한닥 적혀있습니다.</p>

<p>즉 , default 값으로 sequentialsampler를 사용하는데 , 이 sequentialsampler는 <code class="language-plaintext highlighter-rouge">iter</code> method에서 dataset의 len() method를 필요로 하기에 , len method를 implementation을 해주어야 합니다. Python의 built-in iter method는 <code class="language-plaintext highlighter-rouge">__len__</code> method를 필요로 하지 않는데, 아마도 Pytorch에서 overriding을 한 거 같습니다.</p>

<h3 id="using-with-dataloader">Using with Dataloader</h3>

<p>sampler에 어떠한 argument를 넘기지 않았을 때에는, integer index를 yield하는 index sampler를 생성합니다.</p>

<p>map-style dataset 특성상 non-integer index를 가질 수 있는데 , 이러한 경우에는 custom sampler가 필요합니다. (추후 Sampler part에서 자세히 설명하도록 하겠습니다.)</p>

<h2 id="iterable-style-dataset">Iterable-style dataset</h2>

<p>IterableDataset의 subclass의 instance를 iterable-style dataset이라 합니다.</p>

<p>iterable-style dataset은 아래와 같은 protocol(method)를 구현해야 합니다.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">__iter__()</code></li>
</ul>

<p>iterable style은 data sample에 대한 iterable 입니다. <code class="language-plaintext highlighter-rouge">__getitem__</code> method를 implementation을 하지 않기 때문에 , random read가 비용이 크면서 불가능하고 ,batch size가 fetch 된 data에따라 다른데 적합합니다.</p>

<p><code class="language-plaintext highlighter-rouge">iter</code>  method 특성상 stream을 return 하기에 한번에  메모리에 담을 수 없는 database, remote server, 실시간 log등에 적합합니다.</p>

<h3 id="using-with-dataloader-1">Using with Dataloader</h3>

<p>map-style dataset과는 달리 dataset에서 각 item을 yield하는 iterator를 return합니다.</p>

<h1 id="data-loading-in-map-style-dataset">Data loading in map-style dataset</h1>

<p>Iterable dataset의 경우 아래와 같은 특징을 지닙니다.</p>

<ul>
  <li>user-defined iterable에 따라 data loading 순서가 정해집니다.</li>
  <li>임의의 chunk reading, dynamic batch size를 쉽게 구현을 할 수 있습니다.</li>
</ul>

<p>Q . 그렇다면 Map-style dataset은 어떻게 해야 할까요?</p>

<p>A . map-style의 경우 sampler를 이용합니다.</p>

<h2 id="sampler">Sampler</h2>

<p><code class="language-plaintext highlighter-rouge">torch.utils.data.Sampler</code> 의 경우 아래와 같은 특징을 지닙니다.</p>

<ul>
  <li>[indicies/or(key)] 의 sequence를 특정해주고 , 이 sequence를 data loading에 사용합니다.</li>
  <li>indicies에 대한 iterable object입니다.</li>
</ul>

<p>Dataloader의 sampler 와 관련된 argument에 따라 어떤 sampler가 사용될지 결정됩니다.</p>

<ul>
  <li>
    <p>Dataloader에서 shuffle argument 가 None이면 SequentialSampler , 아니라면 shuffled sampler가 default sampler로 assign됩니다.</p>
  </li>
  <li>sampler argument는 어떤 arugment를 pass하지 않아도 default로 SequentialSampler가 사용됩니다.</li>
  <li>sampler arugment에 custom sampler 를 pass하면 custom sampler를 사용할 수 있습니다.</li>
  <li>batch sampler argument에 batch indicies를 yield하는 custom sampler를 사용할 수 있습니다.</li>
</ul>

<h2 id="integer-indicies-sampler">Integer Indicies Sampler</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MySamplerTestDataset</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">inp</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">inp</span>  <span class="o">=</span><span class="n">inp</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">inp</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">inp</span><span class="p">)</span>

    
    
</code></pre></div></div>

<h4 id="default-sampler">default sampler</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="n">IntegerIndiciesSamplerdataset</span> <span class="o">=</span> <span class="n">MySamplerTestDataset</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">IntegerIndiciesSamplerdataset</span><span class="p">,</span><span class="n">sampler</span><span class="o">=</span><span class="bp">None</span> <span class="p">)))</span>



</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>tensor<span class="o">([</span>0]<span class="o">)</span>, tensor<span class="o">([</span>1]<span class="o">)</span>, tensor<span class="o">([</span>2]<span class="o">)</span>, tensor<span class="o">([</span>3]<span class="o">)</span>, tensor<span class="o">([</span>4]<span class="o">)</span>, tensor<span class="o">([</span>5]<span class="o">)</span>, tensor<span class="o">([</span>6]<span class="o">)</span>, tensor<span class="o">([</span>7]<span class="o">)</span>, tensor<span class="o">([</span>8]<span class="o">)</span>, tensor<span class="o">([</span>9]<span class="o">)</span>, tensor<span class="o">([</span>10]<span class="o">)</span>, tensor<span class="o">([</span>11]<span class="o">)</span>, tensor<span class="o">([</span>12]<span class="o">)</span>, tensor<span class="o">([</span>13]<span class="o">)</span>, tensor<span class="o">([</span>14]<span class="o">)</span>, tensor<span class="o">([</span>15]<span class="o">)</span>, tensor<span class="o">([</span>16]<span class="o">)</span>, tensor<span class="o">([</span>17]<span class="o">)</span>, tensor<span class="o">([</span>18]<span class="o">)</span>, tensor<span class="o">([</span>19]<span class="o">)</span>, tensor<span class="o">([</span>20]<span class="o">)</span>, tensor<span class="o">([</span>21]<span class="o">)</span>, tensor<span class="o">([</span>22]<span class="o">)</span>, tensor<span class="o">([</span>23]<span class="o">)</span>, tensor<span class="o">([</span>24]<span class="o">)</span>, tensor<span class="o">([</span>25]<span class="o">)</span>, tensor<span class="o">([</span>26]<span class="o">)</span>, tensor<span class="o">([</span>27]<span class="o">)</span>, tensor<span class="o">([</span>28]<span class="o">)</span>, tensor<span class="o">([</span>29]<span class="o">)</span>, tensor<span class="o">([</span>30]<span class="o">)</span>, tensor<span class="o">([</span>31]<span class="o">)</span>, tensor<span class="o">([</span>32]<span class="o">)</span>, tensor<span class="o">([</span>33]<span class="o">)</span>, tensor<span class="o">([</span>34]<span class="o">)</span>, tensor<span class="o">([</span>35]<span class="o">)</span>, tensor<span class="o">([</span>36]<span class="o">)</span>, tensor<span class="o">([</span>37]<span class="o">)</span>, tensor<span class="o">([</span>38]<span class="o">)</span>, tensor<span class="o">([</span>39]<span class="o">)</span>, tensor<span class="o">([</span>40]<span class="o">)</span>, tensor<span class="o">([</span>41]<span class="o">)</span>, tensor<span class="o">([</span>42]<span class="o">)</span>, tensor<span class="o">([</span>43]<span class="o">)</span>, tensor<span class="o">([</span>44]<span class="o">)</span>, tensor<span class="o">([</span>45]<span class="o">)</span>, tensor<span class="o">([</span>46]<span class="o">)</span>, tensor<span class="o">([</span>47]<span class="o">)</span>, tensor<span class="o">([</span>48]<span class="o">)</span>, tensor<span class="o">([</span>49]<span class="o">)</span>, tensor<span class="o">([</span>50]<span class="o">)</span>, tensor<span class="o">([</span>51]<span class="o">)</span>, tensor<span class="o">([</span>52]<span class="o">)</span>, tensor<span class="o">([</span>53]<span class="o">)</span>, tensor<span class="o">([</span>54]<span class="o">)</span>, tensor<span class="o">([</span>55]<span class="o">)</span>, tensor<span class="o">([</span>56]<span class="o">)</span>, tensor<span class="o">([</span>57]<span class="o">)</span>, tensor<span class="o">([</span>58]<span class="o">)</span>, tensor<span class="o">([</span>59]<span class="o">)</span>, tensor<span class="o">([</span>60]<span class="o">)</span>, tensor<span class="o">([</span>61]<span class="o">)</span>, tensor<span class="o">([</span>62]<span class="o">)</span>, tensor<span class="o">([</span>63]<span class="o">)</span>, tensor<span class="o">([</span>64]<span class="o">)</span>, tensor<span class="o">([</span>65]<span class="o">)</span>, tensor<span class="o">([</span>66]<span class="o">)</span>, tensor<span class="o">([</span>67]<span class="o">)</span>, tensor<span class="o">([</span>68]<span class="o">)</span>, tensor<span class="o">([</span>69]<span class="o">)</span>, tensor<span class="o">([</span>70]<span class="o">)</span>, tensor<span class="o">([</span>71]<span class="o">)</span>, tensor<span class="o">([</span>72]<span class="o">)</span>, tensor<span class="o">([</span>73]<span class="o">)</span>, tensor<span class="o">([</span>74]<span class="o">)</span>, tensor<span class="o">([</span>75]<span class="o">)</span>, tensor<span class="o">([</span>76]<span class="o">)</span>, tensor<span class="o">([</span>77]<span class="o">)</span>, tensor<span class="o">([</span>78]<span class="o">)</span>, tensor<span class="o">([</span>79]<span class="o">)</span>, tensor<span class="o">([</span>80]<span class="o">)</span>, tensor<span class="o">([</span>81]<span class="o">)</span>, tensor<span class="o">([</span>82]<span class="o">)</span>, tensor<span class="o">([</span>83]<span class="o">)</span>, tensor<span class="o">([</span>84]<span class="o">)</span>, tensor<span class="o">([</span>85]<span class="o">)</span>, tensor<span class="o">([</span>86]<span class="o">)</span>, tensor<span class="o">([</span>87]<span class="o">)</span>, tensor<span class="o">([</span>88]<span class="o">)</span>, tensor<span class="o">([</span>89]<span class="o">)</span>, tensor<span class="o">([</span>90]<span class="o">)</span>, tensor<span class="o">([</span>91]<span class="o">)</span>, tensor<span class="o">([</span>92]<span class="o">)</span>, tensor<span class="o">([</span>93]<span class="o">)</span>, tensor<span class="o">([</span>94]<span class="o">)</span>, tensor<span class="o">([</span>95]<span class="o">)</span>, tensor<span class="o">([</span>96]<span class="o">)</span>, tensor<span class="o">([</span>97]<span class="o">)</span>, tensor<span class="o">([</span>98]<span class="o">)</span>, tensor<span class="o">([</span>99]<span class="o">)]</span>
</code></pre></div></div>

<p>default sampler의 경우  sequentialsampler를 사용하므로 위와 같이 순서대로 출력됨을 알 수 있습니다.</p>

<h4 id="shuffle-sampler">shuffle sampler</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Randomsampler</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">RandomSampler</span><span class="p">(</span><span class="n">IntegerIndiciesSamplerdataset</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">IntegerIndiciesSamplerdataset</span> <span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[tensor([63]), tensor([32]), tensor([15]), tensor([25]), tensor([9]), tensor([31]), tensor([87]), tensor([68]), tensor([10]), tensor([42]), tensor([21]), tensor([72]), tensor([24]), tensor([56]), tensor([71]), tensor([70]), tensor([78]), tensor([14]), tensor([73]), tensor([83]), tensor([76]), tensor([16]), tensor([18]), tensor([5]), tensor([49]), tensor([29]), tensor([39]), tensor([77]), tensor([26]), tensor([45]), tensor([52]), tensor([8]), tensor([86]), tensor([17]), tensor([7]), tensor([88]), tensor([59]), tensor([55]), tensor([54]), tensor([35]), tensor([22]), tensor([0]), tensor([57]), tensor([92]), tensor([20]), tensor([64]), tensor([75]), tensor([43]), tensor([85]), tensor([1]), tensor([2]), tensor([89]), tensor([46]), tensor([28]), tensor([11]), tensor([82]), tensor([80]), tensor([91]), tensor([27]), tensor([6]), tensor([79]), tensor([44]), tensor([19]), tensor([58]), tensor([4]), tensor([47]), tensor([90]), tensor([51]), tensor([81]), tensor([33]), tensor([67]), tensor([50]), tensor([61]), tensor([3]), tensor([97]), tensor([93]), tensor([84]), tensor([48]), tensor([34]), tensor([66]), tensor([62]), tensor([41]), tensor([53]), tensor([23]), tensor([74]), tensor([60]), tensor([96]), tensor([30]), tensor([69]), tensor([12]), tensor([37]), tensor([65]), tensor([98]), tensor([13]), tensor([36]), tensor([38]), tensor([94]), tensor([95]), tensor([99]), tensor([40])]

</code></pre></div></div>

<p>shuffle argument를 true로 만드는 경우 , 위와 같이 shuffle이 되어서 나옴을 알 수 있습니다.</p>

<h2 id="non-integral-sampler">Non-integral sampler</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a = np.arange(100)

b = np.arange(100 , 200)

c = np.arange(200,300)

dic = {'a' : a, 'b' :b , 'c' : c}

class MySamplerTestDataset(torch.utils.data.Dataset) :

    def __init__(self , inp):
        self.inp  =inp

    def __getitem__(self , idx) :
        print(f"idx : {idx}")
        return self.inp[idx]
        ...
    def __len__(self):

        return len(self.inp)

    
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class CustomSampler(torch.utils.data.Sampler) :
    def __init__(self, data_source) :
        self.data_source = data_source
    def __iter__(self) :
        print('hi')

        return iter(self.data_source)
        # return iter(['a' , 'b' , 'c'])
    def __len__(self) :
        return len(self.data_source)
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NonintegerSamplerTestDataset = MySamplerTestDataset(dic)

nonintegersampler = CustomSampler(dic.keys())

print(list(torch.utils.data.DataLoader(NonintegerSamplerTestDataset , sampler = nonintegersampler)))
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hi
idx : a
idx : b
idx : c
[tensor([[ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
         18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
         36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
         54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
         72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
         90, 91, 92, 93, 94, 95, 96, 97, 98, 99]]), tensor([[100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113,
         114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127,
         128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141,
         142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155,
         156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169,
         170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183,
         184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197,
         198, 199]]), tensor([[200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213,
         214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227,
         228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241,
         242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255,
         256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269,
         270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283,
         284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297,
         298, 299]])]
</code></pre></div></div>

<p>이번에는 non-integral indicies에 대한 example을 보도록 하겠습니다.</p>

<p>위의 예제에서는 numpy array a , b , c를 item으로 하고 , 각 key를 a , b, c로 설정하였습니다.</p>

<p><code class="language-plaintext highlighter-rouge">iter</code> method를  override할 때 , hi라는 단어를 출력하도록 하였는데 , sampler 에 대한 iterator를 한번만 assign하는 것을 볼 수 있습니다. iterator를 한번만 호출하고 next method로 data sample을 yield하기 때문입니다.</p>

<h2 id="custom-batch-sampler">Custom batch Sampler</h2>

<p>위의 예제에서는 sampler가 전체 indicies를 yield하도록 해서 , 한번에 각 data sample을 for loop으로 iterate하는 형식이였습니다. 하지만 , custom batch sampler를 이용해서 data sample을 batch단위로 iterate할 수 있게 해줍니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MySamplerTestDataset</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">inp</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">inp</span>  <span class="o">=</span><span class="n">inp</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">inp</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="p">...</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">inp</span><span class="p">)</span>

    
<span class="k">class</span> <span class="nc">CustomSampler</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">Sampler</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_source</span><span class="p">)</span> <span class="p">:</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">data_source</span> <span class="o">=</span> <span class="n">data_source</span>
    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'hi'</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">data_source</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">data_source</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">dds</span>  <span class="o">=</span> <span class="n">MySamplerTestDataset</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">customsampler</span> <span class="o">=</span> <span class="n">CustomSampler</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</code></pre></div></div>

<p>dataset을 정의할 때 이번에는 data set을 10개의 group으로 나누어서 이에대한 iterator를 return하도록 하였습니다.</p>

<h3 id="using-default-sampler-argument">using default sampler argument</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 10개의 element를 가진 sequence를 2개의 batch 로 묶어서 tensor로 만들어서 return한다.


#for indices in batch_sampler:
    # yield collate_fn([dataset[i] for i in indices])
ddd = list(torch.utils.data.DataLoader(dds,sampler = customsampler , batch_size = 1 ))
for dd in ddd :
    print(dd)
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hi
tensor([[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]])
tensor([[10, 11, 12, 13, 14, 15, 16, 17, 18, 19]])
tensor([[20, 21, 22, 23, 24, 25, 26, 27, 28, 29]])
tensor([[30, 31, 32, 33, 34, 35, 36, 37, 38, 39]])
tensor([[40, 41, 42, 43, 44, 45, 46, 47, 48, 49]])
tensor([[50, 51, 52, 53, 54, 55, 56, 57, 58, 59]])
tensor([[60, 61, 62, 63, 64, 65, 66, 67, 68, 69]])
tensor([[70, 71, 72, 73, 74, 75, 76, 77, 78, 79]])
tensor([[80, 81, 82, 83, 84, 85, 86, 87, 88, 89]])
tensor([[90, 91, 92, 93, 94, 95, 96, 97, 98, 99]])
</code></pre></div></div>

<p>default sampler agument를 사용하면 list의 list가 결과로 나옴을 알 수 있습니다.</p>

<p>dataloader에서 batch_size, drop_last argument로 개별 sample 대신에 batched sample을 yield하게 됩니다 . 따라서, 위의 예제의 경우 각 sample을 10개의 group으로 사용하였기에 , 10개의 group이 individual batch_sample이 되고 batch_size만큼의 individual batch sample을 list로 collate_fn의 argument로 passing해줍니다. 따라서, list의 list가 결과값으로 나오게 됩니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 10개의 element를 가진 sequence를 2개의 batch 로 묶어서 tensor로 만들어서 return한다.
</span>
<span class="c1">#for index in sampler:
</span>    <span class="c1"># yield collate_fn(dataset[index])
</span>
<span class="n">ddd</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dds</span><span class="p">,</span><span class="n">sampler</span> <span class="o">=</span> <span class="n">customsampler</span> <span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">))</span>
<span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="n">ddd</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
    
<span class="n">hi</span>
<span class="n">tensor</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">]])</span>
<span class="n">tensor</span><span class="p">([[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">]])</span>
<span class="n">tensor</span><span class="p">([[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">]])</span>
<span class="n">tensor</span><span class="p">([[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">]])</span>
<span class="n">tensor</span><span class="p">([[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">]])</span>
</code></pre></div></div>

<p>만약에 batch_size를 2로 설정한다면 위와 같이 결과값이 나오게 됩니다.</p>

<h3 id="using-batch-sampler-argument">using batch sampler argument</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ddd</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dds</span><span class="p">,</span><span class="n">batch_sampler</span> <span class="o">=</span> <span class="n">customsampler</span>  <span class="p">))</span>

<span class="c1">#for indices in batch_sampler:
</span>    <span class="c1"># yield collate_fn([dataset[i] for i in indices])
</span><span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="n">ddd</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hi
tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
tensor([10, 11, 12, 13, 14, 15, 16, 17, 18, 19])
tensor([20, 21, 22, 23, 24, 25, 26, 27, 28, 29])
tensor([30, 31, 32, 33, 34, 35, 36, 37, 38, 39])
tensor([40, 41, 42, 43, 44, 45, 46, 47, 48, 49])
tensor([50, 51, 52, 53, 54, 55, 56, 57, 58, 59])
tensor([60, 61, 62, 63, 64, 65, 66, 67, 68, 69])
tensor([70, 71, 72, 73, 74, 75, 76, 77, 78, 79])
tensor([80, 81, 82, 83, 84, 85, 86, 87, 88, 89])
tensor([90, 91, 92, 93, 94, 95, 96, 97, 98, 99])
</code></pre></div></div>

<p>만약에 , batch_sampler argument를 사용한다면 어떻게 될까요?</p>

<p>batch_sampler를 사용하게 된다면 , batch_sampler를 iterate해서 10개의 indicies를 얻게 되고 , 이를 list comprehension으로 list로 만들어서 collate_fn을 적용하게 됩니다. 따라서, 결과값을 list가 나오게 됩니다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ddd</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">dds</span><span class="p">,</span><span class="n">batch_sampler</span> <span class="o">=</span> <span class="n">customsampler</span> <span class="p">,</span><span class="n">batch_size</span><span class="o">=</span> <span class="mi">3</span> <span class="p">))</span>

<span class="c1">#for indices in batch_sampler:
</span>    <span class="c1"># yield collate_fn([dataset[i] for i in indices])
</span><span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="n">ddd</span> <span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>
    
    
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
&lt;ipython-input-16-05e1dcc877a7&gt; in &lt;module&gt;()
----&gt; 1 ddd = list(torch.utils.data.DataLoader(dds,batch_sampler = customsampler ,batch_size= 3 ))
      2 
      3 #for indices in batch_sampler:
      4     # yield collate_fn([dataset[i] for i in indices])
      5 for dd in ddd :

/usr/local/lib/python3.7/dist-packages/torch/utils/data/dataloader.py in __init__(self, dataset, batch_size, shuffle, sampler, batch_sampler, num_workers, collate_fn, pin_memory, drop_last, timeout, worker_init_fn, multiprocessing_context, generator, prefetch_factor, persistent_workers)
    249             # auto_collation with custom batch_sampler
    250             if batch_size != 1 or shuffle or sampler is not None or drop_last:
--&gt; 251                 raise ValueError('batch_sampler option is mutually exclusive '
    252                                  'with batch_size, shuffle, sampler, and '
    253                                  'drop_last')

ValueError: batch_sampler option is mutually exclusive with batch_size, shuffle, sampler, and drop_last
</code></pre></div></div>

<p>만약에 , batch_size와 drop_last를 batch_sampler argument가 None이 아닐때 같이 사용하게 된다면, batch_sampler는 batch_szie,shuffle,sampler 그리고 drop_last argument와는 mutually exclusive하기 때문에 같이 사용할 수 없다는 것을 아셔야 합니다.</p>

<h2 id="iterative-with-sampler-not-allowed">Iterative with Sampler not allowed</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a = np.arange(100)

b = np.arange(100 , 200)

c = np.arange(200,300)

dic = {'a' : a, 'b' :b , 'c' : c}

class MySamplerTestIterableDatset(torch.utils.data.IterableDataset) :
    def __init__(self,inp) :
        self.inp =inp 
    def __iter__(self) :
        return iter(self.inp)
    def __len__(self) :
        return len(self.inp)

itercustomsamplerdataset = MySamplerTestIterableDatset(dic)

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>itersampler  = torch.utils.data.RandomSampler(itercustomsamplerdataset)

# iterable dataset에  sampler, batch_sampler ,batch_size를 적용하면 안된다.

print(list(torch.utils.data.DataLoader(itercustomsamplerdataset ,batch_size = 4, batch_sampler = itersampler)))
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
&lt;ipython-input-36-5a86c478aaf9&gt; in &lt;module&gt;()
      1 # iterable dataset에  sampler, batch_sampler ,batch_size를 적용하면 안된다.
      2 
----&gt; 3 print(list(torch.utils.data.DataLoader(itercustomsamplerdataset ,batch_size = 4, batch_sampler = itersampler)))

/usr/local/lib/python3.7/dist-packages/torch/utils/data/dataloader.py in __init__(self, dataset, batch_size, shuffle, sampler, batch_sampler, num_workers, collate_fn, pin_memory, drop_last, timeout, worker_init_fn, multiprocessing_context, generator, prefetch_factor, persistent_workers)
    238                 raise ValueError(
    239                     "DataLoader with IterableDataset: expected unspecified "
--&gt; 240                     "batch_sampler option, but got batch_sampler={}".format(batch_sampler))
    241         else:
    242             self._dataset_kind = _DatasetKind.Map

ValueError: DataLoader with IterableDataset: expected unspecified batch_sampler option, but got batch_sampler=&lt;torch.utils.data.sampler.RandomSampler object at 0x7f5511cf1690&gt;
</code></pre></div></div>

<p>Sampler는 indicies를 yield하기 때문에, iterator를 이용해 iterate하는 Iterable Dataset과는 같이 사용될 수 없습니다.</p>

<p>즉, batch_sampler , sampler argument를 Iterable Dataset에서는 사용할 수 없습니다.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#deep-learning" class="page__taxonomy-item p-category" rel="tag">deep learning</a><span class="sep">, </span>
    
      <a href="/tags/#machine-learning" class="page__taxonomy-item p-category" rel="tag">Machine Learning</a><span class="sep">, </span>
    
      <a href="/tags/#pytorch" class="page__taxonomy-item p-category" rel="tag">Pytorch</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#pytorch" class="page__taxonomy-item p-category" rel="tag">Pytorch</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2022-03-10T00:00:00+09:00">March 10, 2022</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Pytorch+data+api+%3A+sampler+and+dataset+style%20%2Fpytorch%2FPytorch-data-api-dataset-and-sampler%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=%2Fpytorch%2FPytorch-data-api-dataset-and-sampler%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=%2Fpytorch%2FPytorch-data-api-dataset-and-sampler%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      


  

  
  	
  	
  	
  	
  	


  <nav class="pagination_prev_next">
    
      <a href="/pytorch/Pytorch-Subsampling/" class="pagination_prev_next--pager"><span class="prev_next">이전 글  &nbsp</span>Pytorch SubSampling : Dataloaer & SubSampler, ranodm_split , Subset</a>
    
    
      <a href="/pytorch/Single-and-MultiProcessing/" class="pagination_prev_next--pager"><span class="prev_next">다음 글  &nbsp  </span>Pytorch data api : Multiprocessing</a>
    
  </nav>


<!-- 
  <nav class="pagination">
    
      <a href="/linear%20algebra/What-is-vector/" class="pagination--pager" title="what is vector and operating on vectors:Computer Science perspective
">Previous</a>
    
    
      <a href="/statistics/Analyzing-Categorical-data/" class="pagination--pager" title="Categorical variable’s representation and interpretation
">Next</a>
    
  </nav>
 -->
    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You may also enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/network/The-Physical-Layer/" rel="permalink">The Phyiscal Layer
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">TCP 5 layer model-phyiscal
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/pytorch/Single-and-MultiProcessing/" rel="permalink">Pytorch data api : Multiprocessing
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          10 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Pytorch multiprocess
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/python/Numeric/" rel="permalink">Numerics
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Python Numerics
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/standfordml/polynominal-regerssion/" rel="permalink">Polynomial Regression
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Standford ML
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Choi Woongjoon. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
<script src="/assets/js/main.min.js"></script>







    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', 'woongjoonchoi/Comments');
    script.setAttribute('issue-term', 'pathname');
    script.setAttribute('theme', 'photon-dark');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>
  



<script type="text/javascript" async
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
extensions: ["tex2jax.js"],
jax: ["input/TeX", "output/HTML-CSS"],
tex2jax: {
inlineMath: [ ['$','$'], ["\\(","\\)"] ],
displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
processEscapes: true
},
"HTML-CSS": { availableFonts: ["TeX"] }
});
</script>

  </body>
</html>
